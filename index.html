<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Moon's Hearth - The Provisioner's Almanac</title>
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
<style>
    :root {
        --gold: #d4af37;
        --gold-glow: rgba(212, 175, 55, 0.4);
        --fire: #ff6a00;
        --glass: rgba(10, 8, 6, 0.85);
        --text: #fdf5e6;
        --parchment: #e3d5b8;
        --ink: #2c1810;
    }

    body, html {
        margin: 0; padding: 0; width: 100%; height: 100%;
        font-family: 'Cormorant Garamond', serif;
        background-color: #000; color: var(--text);
        overflow: hidden; cursor: crosshair;
    }

    /* --- Cinematic Entrance --- */
    #enter-overlay {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: radial-gradient(circle, #1a120e 0%, #000 100%);
        z-index: 1000; display: flex; flex-direction: column;
        justify-content: center; align-items: center; transition: opacity 1s ease;
    }
    .enter-btn {
        font-family: 'Cinzel', serif; font-size: 1.5rem; color: var(--gold);
        background: rgba(0,0,0,0.5); border: 1px solid var(--gold); padding: 15px 45px;
        cursor: pointer; letter-spacing: 5px; transition: 0.4s;
        box-shadow: 0 0 30px var(--gold-glow);
    }
    .enter-btn:hover { background: var(--gold); color: #000; box-shadow: 0 0 50px var(--gold); }

    /* --- Atmosphere --- */
    .bg-layer {
        position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        background: url('image_5.png') no-repeat center center;
        background-size: cover; z-index: 0; animation: flicker 10s infinite alternate;
    }
    @keyframes flicker { 0% { filter: brightness(0.7); } 100% { filter: brightness(0.9); } }
    .vignette {
        position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        background: radial-gradient(circle, transparent 20%, rgba(0,0,0,0.95) 100%);
        z-index: 1; pointer-events: none;
    }

    /* --- Almanac Panel --- */
    .ui-container {
        position: absolute; right: 40px; top: 50%; transform: translateY(-50%);
        z-index: 10; display: flex; flex-direction: column; gap: 20px; width: 440px;
    }
    .glass-panel {
        background: var(--glass); backdrop-filter: blur(25px);
        border: 1px solid var(--gold-glow); padding: 30px;
        box-shadow: 0 25px 70px #000;
    }
    .almanac-header { text-align: center; border-bottom: 1px solid var(--gold); padding-bottom: 10px; margin-bottom: 20px; }
    .almanac-header h1 { font-family: 'Cinzel', serif; font-size: 1.6rem; color: var(--gold); margin: 0; }

    /* --- Calendar Grid --- */
    .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; text-align: center; font-family: 'Cinzel'; font-size: 0.7rem; }
    .day-name { color: var(--gold); padding-bottom: 10px; }
    .day-num { padding: 8px; border: 1px solid rgba(212, 175, 55, 0.1); cursor: pointer; transition: 0.3s; }
    .day-num:hover { background: rgba(212, 175, 55, 0.2); color: var(--gold); }
    .day-num.today { background: var(--gold); color: #000; font-weight: bold; }
    .day-num.has-log { border-color: var(--gold); color: var(--gold); }

    /* --- Modal Scroll --- */
    #log-modal {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.85); z-index: 2000; display: none;
        justify-content: center; align-items: center; opacity: 0; transition: 0.5s;
    }
    .scroll-parchment {
        background: var(--parchment); color: var(--ink); width: 80%; max-width: 500px;
        padding: 50px; border: 2px solid #8b5a2b; box-shadow: 0 0 50px #000;
        border-radius: 5px 40px 5px 40px; position: relative;
    }
    .close-log { position: absolute; top: 20px; right: 30px; cursor: pointer; font-size: 2rem; }
    textarea {
        width: 100%; height: 150px; background: transparent; border: none;
        border-bottom: 1px solid #8b5a2b; font-family: 'Cormorant Garamond';
        font-size: 1.3rem; outline: none; resize: none; margin-top: 20px;
    }
    .save-btn {
        margin-top: 20px; font-family: 'Cinzel'; background: #8b5a2b; color: #fff;
        border: none; padding: 10px 25px; cursor: pointer; width: 100%;
    }

    #particles { position: absolute; width: 100%; height: 100%; z-index: 2; pointer-events: none; }
    .ember { position: absolute; bottom: -20px; background: var(--fire); border-radius: 50%; opacity: 0; animation: rise linear infinite; }
    @keyframes rise { 0% { opacity: 0; transform: translateY(0); } 100% { opacity: 0; transform: translateY(-100vh) translateX(var(--drift)); } }
</style>
</head>
<body>

    <div id="enter-overlay">
        <h2 style="font-family:'Cinzel'; color:var(--gold); letter-spacing:10px; margin-bottom:30px;">MOON'S HEARTH</h2>
        <button class="enter-btn" onclick="igniteHearth()">Enter the Hearth</button>
    </div>

    <div class="bg-layer"></div>
    <div class="vignette"></div>
    <div id="particles"></div>
    <audio id="hearth-audio" loop><source src="fire.mp3" type="audio/mpeg"></audio>

    <div class="ui-container">
        <div class="glass-panel">
            <div class="almanac-header">
                <h1 id="current-month">The Almanac</h1>
                <p id="current-year" style="font-family:'Cinzel'; font-size:0.6rem; color:var(--gold); margin:5px 0 0 0;"></p>
            </div>
            <div class="calendar-grid" id="calendar-body"></div>
            <p style="font-size: 0.8rem; text-align: center; margin-top: 15px; opacity: 0.6; font-style: italic;">
                Click a day to log your provisions.
            </p>
        </div>
    </div>

    <div id="log-modal" onclick="closeLog()">
        <div class="scroll-parchment" onclick="event.stopPropagation()">
            <span class="close-log" onclick="closeLog()">Ã—</span>
            <h2 id="log-date-title" style="font-family:'Cinzel'; text-align:center; border-bottom: 1px solid #8b5a2b;"></h2>
            <textarea id="log-entry" placeholder="What is on the hearth today?"></textarea>
            <button class="save-btn" onclick="saveLog()">Record Provision</button>
        </div>
    </div>

    <script>
        const audio = document.getElementById('hearth-audio');
        let selectedDate = '';

        function igniteHearth() {
            document.getElementById('enter-overlay').style.opacity = '0';
            setTimeout(() => { document.getElementById('enter-overlay').style.display = 'none'; }, 1000);
            audio.volume = 0.5; audio.play();
            renderCalendar();
        }

        function renderCalendar() {
            const now = new Date();
            const monthNames = ["Morning Star", "Sun's Dawn", "First Seed", "Rain's Hand", "Second Seed", "Midyear", "Sun's Height", "Last Seed", "Hearthfire", "Frostfall", "Sun's Dusk", "Evening Star"];
            document.getElementById('current-month').innerText = monthNames[now.getMonth()];
            document.getElementById('current-year').innerText = "Year " + now.getFullYear();

            const calBody = document.getElementById('calendar-body');
            calBody.innerHTML = '';
            ['S', 'M', 'T', 'W', 'T', 'F', 'S'].forEach(d => {
                let dayEl = document.createElement('div'); dayEl.className = 'day-name'; dayEl.innerText = d;
                calBody.appendChild(dayEl);
            });

            const firstDay = new Date(now.getFullYear(), now.getMonth(), 1).getDay();
            const totalDays = new Date(now.getFullYear(), now.getMonth() + 1, 0).getDate();

            for(let i=0; i<firstDay; i++) calBody.appendChild(document.createElement('div'));

            for(let d=1; d<=totalDays; d++) {
                let dateEl = document.createElement('div');
                dateEl.className = 'day-num';
                let dateKey = `${now.getFullYear()}-${now.getMonth()}-${d}`;
                if(localStorage.getItem(dateKey)) dateEl.classList.add('has-log');
                if(d === now.getDate()) dateEl.classList.add('today');
                dateEl.innerText = d;
                dateEl.onclick = () => openLog(d, dateKey);
                calBody.appendChild(dateEl);
            }
        }

        function openLog(day, key) {
            selectedDate = key;
            const month = document.getElementById('current-month').innerText;
            document.getElementById('log-date-title').innerText = `${month} ${day}`;
            document.getElementById('log-entry').value = localStorage.getItem(key) || '';
            const modal = document.getElementById('log-modal');
            modal.style.display = 'flex';
            setTimeout(() => { modal.style.opacity = '1'; }, 10);
        }

        function saveLog() {
            const entry = document.getElementById('log-entry').value;
            if (entry.trim() === '') { localStorage.removeItem(selectedDate); }
            else { localStorage.setItem(selectedDate, entry); }
            closeLog();
            renderCalendar();
        }

        function closeLog() {
            const modal = document.getElementById('log-modal');
            modal.style.opacity = '0';
            setTimeout(() => { modal.style.display = 'none'; }, 500);
        }

        const pCont = document.getElementById('particles');
        for(let i=0; i<30; i++) {
            let e = document.createElement('div');
            e.className = 'ember'; e.style.left = Math.random() * 100 + '%';
            let s = (Math.random() * 3 + 1) + 'px'; e.style.width = s; e.style.height = s;
            e.style.animationDuration = (Math.random() * 5 + 4) + 's';
            e.style.setProperty('--drift', (Math.random() - 0.5) * 80 + 'px');
            pCont.appendChild(e);
        }
    </script>
</body>
</html>
